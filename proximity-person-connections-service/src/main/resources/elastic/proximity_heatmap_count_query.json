{
  "query": {
    "range": {
      "timestamp": {
        "gte": "%s"
      }
    }
  },
  "size": 0,
  "aggs": {
    "heatmap": {
      "geo_distance": {
        "field": "geoLocation",
        "origin": "%s",
        "ranges": [
          {
            "from": 0,
            "to": 10
          },
          {
            "from": 10,
            "to": 50
          },
          {
            "from": 50,
            "to": 100
          },
          {
            "from": 100,
            "to": 200
          },
          {
            "from": 200,
            "to": 500
          },
          {
            "from": 500,
            "to": 1000
          }
        ]
      },
      "aggs": {
        "risks": {
          "terms": {
            "field": "tags"
          }
        }
      }
    }
  }
}